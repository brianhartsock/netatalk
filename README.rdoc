= DESCRIPTION:

Downloads netatalk source package and builds it with SSL support.

= REQUIREMENTS:

Debian/Ubuntu with netatalk 2+.

= ATTRIBUTES:

Attributes are in the "netatalk" attribute key.

* shares - Array of shares, populates AppleVolumes.default, one line per entry. See the netatalk doc for the format of this file.
* share_base - Base directory to share, default /srv/afp_share
* share_base_owner - User that should own the share_base, default root.
* share_base_group - Group that should own the share_base, default root.

= USAGE:

The default netatalk package on Debian/Ubuntu does not have SSL support, so newer Mac OS X clients will be unable to authenticate.

Include the "netatalk" recipe on the desired node's run list. This recipe will include the "netatalk::build_deb" recipe, which downloads the source package and builds with SSL support. The build_deb recipe will install the build dependencies to use debuild to build the netatalk package. This does take quite some time to build.

Once the package is built, it will be installed with dpkg. The base share directory will be created as well, and the AppleVolumes.default share config file will be written.

The shares do need to be configured, and you can set up the attributes in a role, e.g. "netatalk_server" with default or override attributes:

    "netatalk" => {
      "share_base" => "/srv/export",
      "share_base_owner" => "jtimberman",
      "share_base_group" => "jtimberman",
      "shares" => [
        '~/ "Home Directory"',
        '/srv/export/timemachine "TimeMachine" allow:jtimberman cnidscheme:cdb'
      ]
    }

= LICENSE AND AUTHOR:

Author:: Joshua Timberman <joshua@opscode.com>
Copyright 2009-2010, Opscode

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
